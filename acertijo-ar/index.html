
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Acertijo con AR</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>Acertijo</h1>
    <p id="fase-msg">Escanea el marcador Hiro para ver la pregunta</p>
    <div id="riddle-display" style="display: none">
      <div id="answers">
        <div class="answer-option" data-key="correct" data-text="Guardar datos"><p>Guardar datos</p></div>
        <div class="answer-option" data-key="wrong1" data-text="Para restablecer la computadora"><p>Para restablecer la computadora</p></div>
        <div class="answer-option" data-key="wrong2" data-text="Apagar tu PC"><p>Apagar tu PC</p></div>
      </div>
      <p id="result-message">Selecciona una opción.</p>
      <button id="go-ar" disabled>Ver resultado en AR</button>
    </div>
  </div>

  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.min.js"></script>

  <a-scene embedded arjs>
    <a-marker preset="hiro" id="hiro-marker">
      <a-entity id="ar-object"></a-entity>
      <a-text id="ar-text" position="0 0.5 0" align="center" color="#FFFF00" side="double" width="3"></a-text>
    </a-marker>
    <a-entity camera></a-entity>
  </a-scene>

  <script>
    let fase = 0;
    let selectedAnswer = null;
    const questionText = "¿Para qué sirve una variable en programación?";

    const arText = document.getElementById('ar-text');
    const arObject = document.getElementById('ar-object');
    const riddleDisplay = document.getElementById('riddle-display');
    const faseMsg = document.getElementById('fase-msg');

    document.getElementById('hiro-marker').addEventListener('markerFound', () => {
      if (fase === 0) {
        arText.setAttribute('value', questionText);
        faseMsg.innerText = 'Selecciona una respuesta';
        riddleDisplay.style.display = 'block';
        fase = 1;
      } else if (fase === 2) {
        mostrarResultado();
      }
    });

    document.querySelectorAll('.answer-option').forEach(el => {
      el.addEventListener('click', () => {
        selectedAnswer = {
          key: el.getAttribute('data-key'),
          text: el.getAttribute('data-text')
        };
        document.getElementById('result-message').innerText = 'Seleccionaste: ' + selectedAnswer.text;
        document.getElementById('go-ar').disabled = false;
      });
    });

    document.getElementById('go-ar').addEventListener('click', () => {
      fase = 2;
      arText.setAttribute('value', 'Escanea el marcador para ver el resultado');
      // Eliminar hijos manualmente
      while (arObject.firstChild) arObject.removeChild(arObject.firstChild);
    });

    function mostrarResultado() {
      while (arObject.firstChild) arObject.removeChild(arObject.firstChild);

      let entity;
      if (selectedAnswer.key === 'correct') {
        entity = document.createElement('a-box');
        entity.setAttribute('color', '#00ff00');
        entity.setAttribute('depth', '0.3');
        entity.setAttribute('height', '0.3');
        entity.setAttribute('width', '0.3');
        entity.setAttribute('position', '0 0.15 0');
      } else {
        entity = document.createElement('a-sphere');
        entity.setAttribute('color', '#ff0000');
        entity.setAttribute('radius', '0.15');
        entity.setAttribute('position', '0 0.15 0');
      }
      entity.setAttribute('animation', 'property: rotation; to: 0 360 0; loop: true; dur: 3000');
      arObject.appendChild(entity);

      const correct = selectedAnswer.key === 'correct' ? '¡Correcta!' : 'Incorrecta';
      arText.setAttribute('value', 'Tu respuesta fue: ' + selectedAnswer.text + ' | ' + correct);
    }
  </script>
</body>
</html>
  